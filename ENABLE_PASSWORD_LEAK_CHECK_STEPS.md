# パスワード漏洩チェック機能の有効化（詳細手順）

## 概要

Supabase Authは、HaveIBeenPwned.orgのデータベースを使用して、漏洩したパスワードの使用を防ぐことができます。この機能を有効化することで、セキュリティが向上します。

## 有効化手順

### ステップ1: Supabaseダッシュボードにアクセス

1. ブラウザで https://supabase.com/dashboard を開く
2. ログイン（まだログインしていない場合）
3. プロジェクト **lywcdvevizwopochcpic** を選択

### ステップ2: Authentication設定を開く

1. 左サイドバーの **Authentication** をクリック
2. 上部のタブから **Settings** を選択

### ステップ3: Password Protection設定

1. ページを下にスクロールして **Password Protection** セクションを探す
2. **Enable leaked password protection** のトグルスイッチを見つける
3. トグルスイッチを **オン** に変更
4. ページ下部の **Save** ボタンをクリック

### ステップ4: 確認

1. 設定が保存されたことを確認（成功メッセージが表示される）
2. セキュリティ警告が消えていることを確認

## 機能の説明

### HaveIBeenPwned.orgとは

- **データベース**: データ漏洩で公開されたパスワードの大規模なデータベース
- **データ量**: 10億以上の漏洩したパスワードを保持
- **更新頻度**: 定期的に更新され、最新の漏洩情報を含む

### 動作方法

1. ユーザーがパスワードを設定する際、SupabaseがHaveIBeenPwned.orgに照会
2. パスワードの最初の5文字のハッシュを送信（k-anonymity方式）
3. 漏洩したパスワードと一致する場合、エラーメッセージを表示
4. ユーザーは別のパスワードを選択する必要がある

### セキュリティ

- **プライバシー保護**: パスワード全体は送信されない（最初の5文字のハッシュのみ）
- **k-anonymity**: 完全なパスワードを推測できない仕組み
- **安全**: HaveIBeenPwned.orgは信頼できるサービス（Troy Hunt氏が運営）

## ユーザー体験

### 有効化前
- 漏洩したパスワードでも登録可能
- セキュリティリスクが高い

### 有効化後
- 漏洩したパスワードは拒否される
- エラーメッセージ: "This password has been found in a data breach. Please choose a different password."
- より安全なパスワードを強制

## 推奨設定

### 開発環境
- **推奨**: 有効化（セキュリティベストプラクティスに準拠）
- **理由**: 開発中でもセキュリティを意識した実装を維持

### 本番環境
- **必須**: 有効化
- **理由**: ユーザーのアカウントを保護し、データ漏洩のリスクを軽減

## 注意事項

1. **パフォーマンス**: HaveIBeenPwned.orgへのAPIリクエストが発生するため、わずかな遅延が発生する可能性があります（通常は数百ミリ秒）
2. **誤検知**: まれに、安全なパスワードでも漏洩リストに含まれている場合があります
3. **ユーザーサポート**: ユーザーがエラーメッセージを見た場合、別のパスワードを選択するよう案内が必要

## 確認方法

設定後、以下を確認：
1. セキュリティ警告が消えていること
2. 新しいユーザー登録時に、漏洩したパスワード（例: "password123"）が拒否されること
3. 安全なパスワード（例: "MySecureP@ssw0rd2024!") が受け入れられること

## テスト方法

1. サインアップページで、よく知られた漏洩パスワード（例: "password", "123456", "qwerty"）を試す
2. エラーメッセージが表示されることを確認
3. 安全なパスワードで登録できることを確認

